{"componentChunkName":"component---src-templates-post-template-tsx","path":"/230523/app-dir/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>App dir Migration</h1>\n<p>팀내의 next.js 버전을 12에서 13으로 올리면서 새로운 next.js의 기능을 사용하고자 App dir을 사용하게 되었다.</p>\n<p>이로 인해 점진적으로 pages 라우팅 방식을 app 라우팅 방식으로 변경하게 되었다.</p>\n<p>팀내 프론트엔드 개발자들과 함께 보고 마이그레이션 하기위해 공부한 내용을 정리하였다.</p>\n<h1>dependency</h1>\n<p>Next의 App Router 기능을 이용하기 위해선 아래와 같은 버전이 필요합니다.</p>\n<h3>Node.js</h3>\n<p>최소 v16.8</p>\n<h3>Next.js</h3>\n<p>최소 version 13.4</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> next@latest react@latest react-dom@latest</code></pre></div>\n<h3>ESLint</h3>\n<p>ESLint를 사용중이라면, 아래와 같은 dependency를 추가하여야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-D</span> eslint-config-next@latest</code></pre></div>\n<h1>Next Steps</h1>\n<p>공식문서에서 소개하는 업데이트를 완료한 후 다음 단계는 아래와 같습니다.</p>\n<ul>\n<li><a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/app-router-migration#upgrading-new-features\" target=\"_blank\" rel=\"nofollow\">Upgrade new features</a>\n<ul>\n<li>개선된 Image 및 Link 컴포넌트와 같은 새로운 기능으로 업그레이드</li>\n</ul>\n</li>\n<li><a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/app-router-migration#migrating-from-pages-to-app\" target=\"_blank\" rel=\"nofollow\">Migrate from the <code class=\"language-text\">pages</code> to <code class=\"language-text\">app</code> directory</a>\n<ul>\n<li><code class=\"language-text\">pages</code> 에서 <code class=\"language-text\">app</code> 디렉토리로 점진적으로 마이그레이션</li>\n</ul>\n</li>\n</ul>\n<h1>Upgrade new features</h1>\n<p>Next.js 13버전에서는 새로운 기능과 규칙을 갖춘 App Router가 도입되었습니다. 새로운 라우터는 <code class=\"language-text\">app</code> 디렉토리에서 사용가능하며, <code class=\"language-text\">pages</code> 디렉토리와 공존합니다.</p>\n<p>Next.js 13버전으로 업그레이드할 때 App Router는 필수가 아닙니다. <code class=\"language-text\">pages</code> 디렉토리에서도 새로운 Next의 기능을 사용할 수 있습니다.</p>\n<h2><code class=\"language-text\">&lt;Image /></code></h2>\n<p>Next.js 12버전에서 <code class=\"language-text\">next/future/image</code>로 임포트가 되어있는 Image 컴포넌트가 있다면, <code class=\"language-text\">next/image</code> 로 임포트 경로를 변경해야합니다.</p>\n<p>Next.js 13버전이 되며 Image컴포넌트에서는 아래와 같은 개선사항이 있습니다.</p>\n<ul>\n<li>client-side JavaScript 코드량 감소</li>\n<li>더 쉬운 이미지 extend 및 스타일 지정</li>\n<li>accessibility 향상</li>\n<li>네이티브 브라우저 lazy loading</li>\n</ul>\n<p>자세한 Image 컴포넌트의 사용 방법은 [Next공식문서](<a href=\"https://nextjs.org/docs/app/api-reference/components/image%5C)%EB%A5%BC\" target=\"_blank\" rel=\"nofollow\">https://nextjs.org/docs/app/api-reference/components/image\\)를</a> 참고해주세요.</p>\n<h2><code class=\"language-text\">&lt;Link></code></h2>\n<p>이제 Link 컴포넌트는 더이상 수동으로 <code class=\"language-text\">&lt;a></code> tag를 자식으로 둘 필요가 없습니다.</p>\n<p>Next.js 13버전에서는 <code class=\"language-text\">&lt;Link></code>가 항상 <code class=\"language-text\">&lt;a></code> tag를 기본적으로 렌더하게 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> Link <span class=\"token keyword\">from</span> <span class=\"token string\">'next/link'</span>\n\n<span class=\"token comment\">// Next.js 12: `&lt;a>` has to be nested otherwise it's excluded</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/about<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">About</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token comment\">// Next.js 13: `&lt;Link>` always renders `&lt;a>` under the hood</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/about<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  About\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>자세한 Link 컴포넌트의 사용 방법은 <a href=\"https://nextjs.org/docs/app/api-reference/components/link\" target=\"_blank\" rel=\"nofollow\">Next공식문서</a>를 참고해주세요.</p>\n<h2><code class=\"language-text\">&lt;Script></code></h2>\n<p>원활한 마이그레이션을 위해 몇 가지 변경이 필요합니다.</p>\n<ul>\n<li>기존 _document.[js,jsx,tsx]의 <code class=\"language-text\">beforeInteractive</code> 스크립트를 <code class=\"language-text\">app/layout.tsx</code> 로 이동합니다.</li>\n<li><code class=\"language-text\">onLoad</code>, <code class=\"language-text\">onReady</code> 및 <code class=\"language-text\">onError</code> 핸들러는 Server Component에서 동작하지 않으므로, Client Component로 변경하거나 완전히 제거해야 합니다.</li>\n</ul>\n<h2>next/font</h2>\n<p>next/font기능은 font 최적화에 도움을 줍니다.</p>\n<p>하지만 현재(23.05.23)기준 storybook에서 지원하지 않으므로, storybook 공식 지원 시 마이그레이션이 필요합니다.</p>\n<h1>Migrating from <code class=\"language-text\">pages</code> to <code class=\"language-text\">app</code></h1>\n<p>App Router로 이동하는것은, 새로운 React의 기능(Server Components, Suspense …)을 사용하게 되는것입니다.</p>\n<p><code class=\"language-text\">app</code> 디렉토리와 <code class=\"language-text\">pages</code> 디렉토리는 의도적으로 동시에 작동하도록 설계되었으며, 이는 페이지단위의 점진적인 마이그레이션이 가능하도록 도와줍니다.</p>\n<ul>\n<li><code class=\"language-text\">app</code> 디렉토리는 중첩 라우팅과 layouts를 제공합니다. <a href=\"https://nextjs.org/docs/app/building-your-application/routing\" target=\"_blank\" rel=\"nofollow\">문서</a></li>\n<li>중첩된 폴더구조로 라우팅을 정의하고, <code class=\"language-text\">page.[js,jsx,tsx]</code>를 통해 배포하게 됩니다.</li>\n<li>각 라우터마다 <a href=\"https://nextjs.org/docs/app/building-your-application/routing#file-conventions\" target=\"_blank\" rel=\"nofollow\">특수한 예약파일</a>을 사용하게 됩니다. 주로 사용하게 될 예약파일은 <code class=\"language-text\">page.[js,jsx,tsx]</code> 와 <code class=\"language-text\">layout.[js,jsx,tsx]</code> 입니다.\n<ul>\n<li><code class=\"language-text\">page.js</code> 를 사용해 라우팅 기능을 이용합니다.</li>\n<li><code class=\"language-text\">layout.js</code> 를 통해 UI를 공유하고 레이아웃을 정의하게 됩니다.</li>\n<li><code class=\"language-text\">.js</code> <code class=\"language-text\">.jsx</code> <code class=\"language-text\">.tsx</code> 확장자를 이용해 예약 파일을 사용할 수 있습니다.</li>\n</ul>\n</li>\n<li>컴포넌트, 테스트코드, 스타일시트등을 <code class=\"language-text\">app</code> 디렉토리에 포함시킬 수 있습니다.</li>\n<li><code class=\"language-text\">getServerSideProps</code> 와 <code class=\"language-text\">getStaticProps</code> 같은 특수 함수들이 <code class=\"language-text\">app</code> 디렉토리에서 <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching\" target=\"_blank\" rel=\"nofollow\">새로운 API</a>로 대체됩니다.</li>\n<li><code class=\"language-text\">pages</code> 디렉토리에서 사용중이던 예약파일 <code class=\"language-text\">_app</code> 과 <code class=\"language-text\">_document</code> 가 <code class=\"language-text\">app</code> 디렉토리에서 <code class=\"language-text\">layout</code> 으로 대체됩니다. <a href=\"https://nextjs.org/docs/app/building-your-application/routing/pages-and-layouts#root-layout-required\" target=\"_blank\" rel=\"nofollow\">문서</a></li>\n<li><code class=\"language-text\">_error</code> 예약파일이 <code class=\"language-text\">error</code> 로 대체됩니다. <a href=\"https://nextjs.org/docs/app/building-your-application/routing/error-handling\" target=\"_blank\" rel=\"nofollow\">문서</a></li>\n<li><code class=\"language-text\">404</code> 예약파일이 <code class=\"language-text\">not-found</code> 로 대체됩니다. <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/not-found\" target=\"_blank\" rel=\"nofollow\">문서</a></li>\n<li><code class=\"language-text\">pages/api/*</code> 는 아직 그대로 <code class=\"language-text\">pages</code> 디렉토리를 사용합니다.</li>\n</ul>\n<h3>Step1: creating the <code class=\"language-text\">app</code> dir</h3>\n<p>최신버전의 Next.js(최소 13.4이상)을 설치한 후, root 또는 <code class=\"language-text\">src/</code> 아래에 <code class=\"language-text\">app</code> 디렉토리를 생성합니다.</p>\n<h3>Step2: Creating a Root Layout</h3>\n<p><code class=\"language-text\">app</code> 디렉토리 내부에 <code class=\"language-text\">layout.[js,jsx,tsx]</code> 를 생성합니다. 이는 <a href=\"https://nextjs.org/docs/app/building-your-application/routing/pages-and-layouts#root-layout-required\" target=\"_blank\" rel=\"nofollow\">root layout</a>이라 불리며 <code class=\"language-text\">app</code> 디렉토리 내부의 모든 파일에 적용됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">RootLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Layouts must accept a children prop.</span>\n  <span class=\"token comment\">// This will be populated with nested layouts or pages</span>\n  children<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  children<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span>ReactNode\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">app</code> 디렉토리는 항상 root layout을 가져야합니다.</li>\n<li>root layout은 항상 <code class=\"language-text\">&lt;html></code> 과 <code class=\"language-text\">&lt;body></code> 태그를 정의해야합니다. Next.js에서는 자동으로 그들을 생성하지 않습니다.</li>\n<li><code class=\"language-text\">&lt;head></code> 태그를 사용하기 위해서 <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/metadata\" target=\"_blank\" rel=\"nofollow\">built-in SEO support</a>를 사용할 수 있습니다.</li>\n</ul>\n<p><code class=\"language-text\">**_document</code> 와 <code class=\"language-text\">_app</code> 의 마이그레이션**</p>\n<p><code class=\"language-text\">app</code> 디렉토리의 <code class=\"language-text\">layout</code> 파일은 <code class=\"language-text\">app</code> 디렉토리 내부에서만 동작하고 기존의 <code class=\"language-text\">pages</code> 디렉토리에는 적용되지 않습니다. <code class=\"language-text\">pages</code> 디렉토리에서 <code class=\"language-text\">app</code> 디렉토리로 <strong>마이그레이션이 완료된 이후</strong> <code class=\"language-text\">_document</code> 와 <code class=\"language-text\">_app</code> 을 안전하게 삭제하여야 합니다.</p>\n<p>만일, React Context providers를 사용중이라면 반드시 Client Component를 사용해야합니다.</p>\n<h3>Step3: Migrating <code class=\"language-text\">next/head</code></h3>\n<p><code class=\"language-text\">pages</code> 디렉토리에서 <code class=\"language-text\">&lt;Head></code> 컴포넌트를 이용해 정의하던 meta 및 title등을 <code class=\"language-text\">app</code> 디렉토리에서 <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/metadata\" target=\"_blank\" rel=\"nofollow\">built-in SEO support</a>를 이용해 정의하는것으로 변경하여야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// before</span>\n<span class=\"token keyword\">import</span> Head <span class=\"token keyword\">from</span> <span class=\"token string\">'next/head'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Head</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">My page title</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Head</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// after</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Metadata <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> metadata<span class=\"token operator\">:</span> Metadata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  title<span class=\"token operator\">:</span> <span class=\"token string\">'My Page Title'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">'...'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>모든 metadata의 옵션은 <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-metadata\" target=\"_blank\" rel=\"nofollow\">링크</a>를 참고해주세요.</p>\n<h3>Step4: Migrating Pages</h3>\n<ul>\n<li><code class=\"language-text\">app</code> 디렉토리에서는 모든 컴포넌트의 default값이 Server Components입니다. 이는 기존 <code class=\"language-text\">pages</code> 디렉토리에서 모든 컴포넌트의 default값이 Client Components인것과 가장 큰 차이점입니다.</li>\n<li>Data fetching 방식이 변경됩니다. <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching\" target=\"_blank\" rel=\"nofollow\">링크</a> // 추후 추가 문서 작성 필요해보임</li>\n<li><code class=\"language-text\">page.[js,jsx,tsx]</code> 를 통해 라우팅이 제공됩니다.</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>pages</th>\n<th>app</th>\n<th>Route</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>index.js</td>\n<td>page.js</td>\n<td>/</td>\n</tr>\n<tr>\n<td>about.js</td>\n<td>about/page.js</td>\n<td>/about</td>\n</tr>\n<tr>\n<td>blog/[slug].js</td>\n<td>blog/[slug]/page.js</td>\n<td>/blog/post-1</td>\n</tr>\n</tbody>\n</table>\n<p>Vercel측에서는 아래와같은 순서로 마이그레이션을 추천합니다.</p>\n<aside>\n💡 이 방식은 `pages` 디렉토리 방식과 가장 유사한 방법으로 빠르고 쉽게 마이그레이션 하는 방식입니다.\n</aside>\n<ol>\n<li>default exported Page Component를 새로운 Client Component로 이동합니다.</li>\n<li>새로운 Client Component를 <code class=\"language-text\">app</code> 디렉토리 내 <code class=\"language-text\">page.js</code> 파일로 이동합니다.</li>\n</ol>\n<p><strong>Step4-1: Create a new Client Component</strong></p>\n<ol>\n<li><code class=\"language-text\">app</code> 디렉토리 내에 새로운 Client Component를 생성하고 export합니다. (i.e. <code class=\"language-text\">app/home-page.tsx</code>) Client Component를 정의하기 위해서 코드 최상단에 <code class=\"language-text\">‘use client’</code> 구문을 추가합니다.(모든 import 전)</li>\n<li>기존 <code class=\"language-text\">pages/index.js</code> 에서 default export하던 컴포넌트를 <code class=\"language-text\">app/home-page.tsx</code> 로 옮깁니다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/home-page.tsx</span>\n\n<span class=\"token string\">'use client'</span>\n\n<span class=\"token comment\">// This is a Client Component. It receives data as props and</span>\n<span class=\"token comment\">// has access to state and effects just like Page components</span>\n<span class=\"token comment\">// in the `pages` directory.</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">HomePage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> recentPosts <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>recentPosts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>post <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Step4-2: Create a new page</strong></p>\n<ol>\n<li><code class=\"language-text\">app/page.tsx</code> 파일을 <code class=\"language-text\">app</code> 디렉토리 내부에 생성합니다. 이는 default로 Server Component가 됩니다.</li>\n<li>Client Component인 <code class=\"language-text\">home-page.tsx</code> 를 import합니다.</li>\n<li>만일, <code class=\"language-text\">pages/index.js</code> 에서 data fetching이 이루어지고 있엇다면, <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching\" target=\"_blank\" rel=\"nofollow\">변경된 data fetching API</a>를 사용해 로직을 Server Component로 이동합니다. data fetching migration 가이드는 아래에서 자세히 설명 될 예정입니다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Import your Client Component</span>\n<span class=\"token keyword\">import</span> HomePage <span class=\"token keyword\">from</span> <span class=\"token string\">'./home-page'</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getPosts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://...'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> posts\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Fetch data directly in a Server Component</span>\n  <span class=\"token keyword\">const</span> recentPosts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getPosts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// Forward fetched data to your Client Component</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">HomePage</span></span> <span class=\"token attr-name\">recentPosts</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>recentPosts<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>만약, 기존 page에서 <code class=\"language-text\">useRouter</code> hook을 사용중이였다면, 새로운 routing hooks로 변경해야합니다. <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-router\" target=\"_blank\" rel=\"nofollow\">링크</a></p>\n<h3>Step 5: Migrating Routing Hooks</h3>\n<p><code class=\"language-text\">app</code> 디렉토리에서의 새로운 동작을 위해 새로운 routing hook이 추가되었습니다.</p>\n<p><code class=\"language-text\">app</code> 디렉토리 내부에서는 <code class=\"language-text\">useRouter()</code> , <code class=\"language-text\">usePathname()</code> , <code class=\"language-text\">useSearchParams()</code> 세가지 새로운 훅을 반드시 <code class=\"language-text\">next/navigation</code> 에서 import 해야 합니다.</p>\n<ul>\n<li>새로운 <code class=\"language-text\">useRouter</code> 훅은 <code class=\"language-text\">next/navigation</code> 에서 import되며, 기존 <code class=\"language-text\">pages</code> 디렉토리에서 <code class=\"language-text\">next/router</code> 를 통해 import 해오던 <code class=\"language-text\">useRouter</code>와 다른 동작을 가집니다.\n<ul>\n<li><code class=\"language-text\">next/router</code> 를 통해 import 해오던 <code class=\"language-text\">useRouter</code>는 <code class=\"language-text\">app</code> 디렉토리에서 지원되지 않습니다. 하지만 <code class=\"language-text\">pages</code> 디렉토리에서는 계속 동작합니다.</li>\n</ul>\n</li>\n<li>새로운 <code class=\"language-text\">useRouter</code> 는 더이상 <code class=\"language-text\">pathname</code> string, <code class=\"language-text\">query</code> object를 반환하지 않습니다. 이를 이용하기 위해 <code class=\"language-text\">usePathname</code> 과 <code class=\"language-text\">useSearchParams</code> 를 사용해주세요.</li>\n<li><code class=\"language-text\">usePathname</code> , <code class=\"language-text\">useSearchParams</code> 훅을 통해 페이지 변경을 감지할 수 있습니다.</li>\n<li>당연하지만 <code class=\"language-text\">usePathname</code> , <code class=\"language-text\">useSearchParams</code> 훅은 Client Components에서만 동작합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token string\">'use client'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useRouter<span class=\"token punctuation\">,</span> usePathname<span class=\"token punctuation\">,</span> useSearchParams <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/navigation'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">ExampleClientComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token function\">useRouter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> pathname <span class=\"token operator\">=</span> <span class=\"token function\">usePathname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> searchParams <span class=\"token operator\">=</span> <span class=\"token function\">useSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>추가적으로 새로운 <code class=\"language-text\">useRouter</code> 훅에서는 아래와 같은 기능들이 제거됩니다.</p>\n<ul>\n<li><code class=\"language-text\">isFallback</code></li>\n<li><code class=\"language-text\">locale</code>, <code class=\"language-text\">locales</code>, <code class=\"language-text\">defaultLocales</code>, <code class=\"language-text\">domainLocales</code></li>\n<li><code class=\"language-text\">basePath</code></li>\n<li><code class=\"language-text\">asPath</code></li>\n<li><code class=\"language-text\">isReady</code></li>\n</ul>\n<h3>Step 6: Migrating Data Fetching Methods</h3>\n<p>기존 <code class=\"language-text\">pages</code> 디렉토리에서 사용하던 <code class=\"language-text\">getServerSideProps</code> , <code class=\"language-text\">getStaticProps</code> 는 <code class=\"language-text\">app</code> 디렉토리에서 <code class=\"language-text\">async</code> React Server Components와 <code class=\"language-text\">fetch()</code>를 사용하는 <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching\" target=\"_blank\" rel=\"nofollow\">simpler API</a>로 변경됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/page.tsx</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// This request should be cached until manually invalidated.</span>\n  <span class=\"token comment\">// Similar to `getStaticProps`.</span>\n  <span class=\"token comment\">// `force-cache` is the default and can be omitted.</span>\n  <span class=\"token keyword\">const</span> staticData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://...</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> cache<span class=\"token operator\">:</span> <span class=\"token string\">'force-cache'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// This request should be refetched on every request.</span>\n  <span class=\"token comment\">// Similar to `getServerSideProps`.</span>\n  <span class=\"token keyword\">const</span> dynamicData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://...</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> cache<span class=\"token operator\">:</span> <span class=\"token string\">'no-store'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// This request should be cached with a lifetime of 10 seconds.</span>\n  <span class=\"token comment\">// Similar to `getStaticProps` with the `revalidate` option.</span>\n  <span class=\"token keyword\">const</span> revalidatedData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://...</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    next<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> revalidate<span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Server-side Rendering (<code class=\"language-text\">getServerSideProps</code>)</strong></p>\n<p><code class=\"language-text\">pages</code> 디렉토리에서는, <code class=\"language-text\">getServerSideProps</code> 를 사용해 서버에서 data fetching을 진행하고, default export된 React Component에 props를 전달합니다. 페이지 초기 HTML 페이지가 미리 서버에서 준비되고, 브라우저에서 hydrating 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// `pages` directory</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getServerSideProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://...</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> projects <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> projects <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Dashboard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> projects <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>projects<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>project <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>project<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>project<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">app</code> 디렉토리의 Server Components를 사용해 data fetching을 React Component 내부에서 진행할 수 있습니다. 이는 Client의 JavaScript를 적게 전송할 수 있고, 서버에서 HTML을 렌더할 수 있게 만들어줍니다.</p>\n<p><code class=\"language-text\">cache</code> 옵션을 <code class=\"language-text\">no-store</code> 로 설정할 경우, 데이터는 cache되지 않습니다. 이는 <code class=\"language-text\">pages</code> 디렉토리의 <code class=\"language-text\">getServerSideProps</code> 와 유사하게 동작합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/dashboard/page.tsx</span>\n\n<span class=\"token comment\">// `app` directory</span>\n\n<span class=\"token comment\">// This function can be named anything</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getProjects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://...</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> cache<span class=\"token operator\">:</span> <span class=\"token string\">'no-store'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> projects <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> projects\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Dashboard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> projects <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getProjects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>projects<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>project <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>project<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>project<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존 <code class=\"language-text\">pages</code> 디렉토리에서, <code class=\"language-text\">getServerSideProps</code>를 사용할 때 <code class=\"language-text\">req</code> 객채를 참조해 header, cookies를 접근했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// `pages` directory</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getServerSideProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> req<span class=\"token punctuation\">,</span> query <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> authHeader <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">getHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'authorization'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> theme <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>cookies<span class=\"token punctuation\">[</span><span class=\"token string\">'theme'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">app</code> 디렉토리에서는 requset data에 접근하는 새로운 읽기전용 함수가 정의되었습니다.</p>\n<ul>\n<li><code class=\"language-text\">headers()</code> , <code class=\"language-text\">cookies()</code> 를 통해 header와 cookie에 접근할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// `app` directory</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> cookies<span class=\"token punctuation\">,</span> headers <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/headers'</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> authHeader <span class=\"token operator\">=</span> <span class=\"token function\">headers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'authorization'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token string\">'...'</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// You can use `cookies()` or `headers()` inside Server Components</span>\n  <span class=\"token comment\">// directly or in your data fetching function</span>\n  <span class=\"token keyword\">const</span> theme <span class=\"token operator\">=</span> <span class=\"token function\">cookies</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'theme'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">'...'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>SSG</h3>\n<p>현재 프로덕트에 SSG가 적용되어있지 않아 넘어갑니다. 추가적인 정보가 필요하면</p>\n<p><a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/app-router-migration#static-site-generation-getstaticprops\" target=\"_blank\" rel=\"nofollow\">링크</a>를 참고해주세요.</p>\n<h3>Step 7: Styling</h3>\n<p><code class=\"language-text\">pages</code> 디렉토리에서는, <code class=\"language-text\">_app</code> 에서 global 스타일시트를 정의했지만, <code class=\"language-text\">app</code> 디렉토리에서는 layout, page, component에서 각각 적용할 수 있게 됩니다.</p>\n<p>특히, 현재 사용하고있는 CSS-in-JS에 대한 사전 설정이 필요합니다.</p>\n<p>사전 설정과 관련된 문서를 참고해주세요. <a href=\"https://nextjs.org/docs/app/building-your-application/styling/css-in-js\" target=\"_blank\" rel=\"nofollow\">링크</a></p>\n<h2>참고</h2>\n<p><a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/app-router-migration\" target=\"_blank\" rel=\"nofollow\">Upgrading: App Router Migration</a></p>\n<p><a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/codemods\" target=\"_blank\" rel=\"nofollow\">Upgrading: Codemods</a></p>\n<p><a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching\" target=\"_blank\" rel=\"nofollow\">Building Your Application: Data Fetching</a></p>\n<p><a href=\"https://nextjs.org/docs/app/api-reference/functions/use-router\" target=\"_blank\" rel=\"nofollow\">Functions: useRouter</a></p>","frontmatter":{"title":"App dir","summary":"App dir Migration","date":"2023.05.23.","categories":["App dir","Next.js13"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhElEQVR42r1SWwqDMBDM/Y/R2A/RaKmJGqJRqq0i3mnEF4ioYJR+LDswu8MMu+QZ+rizyN8ELeHBhCNHC5QzPAJ37BOeub5vCe86pILBUQLBJ4GXRnhlEmGpYcv3eYezO1/HyNsKuvlC/nKouoCj+MAZR6ZLzJl55OXwetEo8q1XvvKHHTMHYHm6lwOyAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/7bb2f49fd0bc5333e18de57da0d7360f/9b7d7/app-dir.png","srcSet":"/static/7bb2f49fd0bc5333e18de57da0d7360f/5d231/app-dir.png 192w,\n/static/7bb2f49fd0bc5333e18de57da0d7360f/e1116/app-dir.png 384w,\n/static/7bb2f49fd0bc5333e18de57da0d7360f/9b7d7/app-dir.png 768w","sizes":"(min-width: 768px) 768px, 100vw"},"sources":[{"srcSet":"/static/7bb2f49fd0bc5333e18de57da0d7360f/a3a09/app-dir.webp 192w,\n/static/7bb2f49fd0bc5333e18de57da0d7360f/5358b/app-dir.webp 384w,\n/static/7bb2f49fd0bc5333e18de57da0d7360f/81e8e/app-dir.webp 768w","type":"image/webp","sizes":"(min-width: 768px) 768px, 100vw"}]},"width":768,"height":402}},"publicURL":"/static/7bb2f49fd0bc5333e18de57da0d7360f/app-dir.png"}}}}]}},"pageContext":{"slug":"/230523/app-dir/"}},"staticQueryHashes":[],"slicesMap":{}}